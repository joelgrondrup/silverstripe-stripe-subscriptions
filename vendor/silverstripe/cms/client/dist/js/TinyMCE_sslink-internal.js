!function(){"use strict";var e={40:function(e){e.exports=ReactRedux},127:function(e){e.exports=InsertLinkModal},145:function(e){e.exports=ReactDomClient},153:function(e){e.exports=TinyMCEActionRegistrar},207:function(e){e.exports=Injector},502:function(e){e.exports=ShortcodeSerialiser},594:function(e){e.exports=React},669:function(e){e.exports=jQuery},695:function(e){e.exports=ApolloClient},815:function(e){e.exports=i18n}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}!function(){var e=u(n(815)),t=u(n(153)),i=u(n(594)),r=n(145),o=n(695),a=n(40),l=u(n(669)),s=u(n(502)),d=n(127),c=n(207);function u(e){return e&&e.__esModule?e:{default:e}}const p="sslinkinternal",f={init(n){t.default.addAction("sslink",{text:e.default._t("CMS.LINKLABEL_PAGE","Page on this site"),onAction:e=>e.execCommand(p),priority:90},n.getParam("editorIdentifier")).addCommandWithUrlTest(p,/^\[sitetree_link.+]$/),n.addCommand(p,()=>{(0,l.default)(`#${n.id}`).entwine("ss").openLinkInternalDialog()})}},g="insert-link__dialog-wrapper--internal",h=(0,c.provideInjector)((0,d.createInsertLinkModal)("SilverStripe\\CMS\\Controllers\\CMSPageEditController","editorInternalLink"));l.default.entwine("ss",t=>{t("textarea.htmleditor").entwine({openLinkInternalDialog(){let e=t(`#${g}`);e.length||(e=t(`<div id="${g}" />`),t("body").append(e)),e.addClass("insert-link__dialog-wrapper"),e.setElement(this),e.open()}}),t(`#${g}`).entwine({ReactRoot:null,renderModal(t){const n=ss.store,l=ss.apolloClient,s=this.getOriginalAttributes(),d=this.getRequireLinkText();let c=this.getReactRoot();c||(c=(0,r.createRoot)(this[0]),this.setReactRoot(c)),c.render(i.default.createElement(o.ApolloProvider,{client:l},i.default.createElement(a.Provider,{store:n},i.default.createElement(h,{isOpen:t,onInsert:(...e)=>this.handleInsert(...e),onClosed:()=>this.close(),title:e.default._t("CMS.LINK_PAGE","Link to a page"),bodyClassName:"modal__dialog",className:"insert-link__dialog-wrapper--internal",fileAttributes:s,identifier:"Admin.InsertLinkInternalModal",requireLinkText:d}))))},buildAttributes(e){return{href:`${s.default.serialise({name:"sitetree_link",properties:{id:e.PageID}},!0)}${e.Anchor&&e.Anchor.length?`#${e.Anchor}`:""}`,target:e.TargetBlank?"_blank":"",title:e.Description}},getOriginalAttributes(){const e=this.getElement().getEditor(),n=t(e.getSelectedNode()),i=(n.attr("href")||"").split("#");if(!i[0])return{};const r=s.default.match("sitetree_link",!1,i[0]);return r?{PageID:r.properties.id?parseInt(r.properties.id,10):0,Anchor:i[1]||"",Description:n.attr("title"),TargetBlank:!!n.attr("target")}:{}}})}),tinymce.PluginManager.add(p,e=>f.init(e))}()}();